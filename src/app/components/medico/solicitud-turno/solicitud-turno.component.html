<div *ngIf="solicitudesDetalladas$ | async as solicitudes; else noSolicitudes">
  <h3>Solicitudes de cambio o cancelaci√≥n de Turno</h3>
  <table>
    <thead>
      <tr>
        <th>Paciente</th>
        <th>Motivo</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let detalle of solicitudes" (click)="seleccionarSolicitud(detalle.solicitud)">
        <td>{{ detalle.paciente?.nombres | titlecase }} {{ detalle.paciente?.apellidos | titlecase }}</td>
        <td>{{ detalle.solicitud.motivo }}</td>
      </tr>
    </tbody>
  </table>
</div>

<ng-template #noSolicitudes>
  <p>No hay solicitudes pendientes.</p>
</ng-template>

<div *ngIf="solicitudSeleccionada" class="detalle-solicitud">
  <h3>Detalle de la Solicitud Seleccionada</h3>
  <p><strong>Paciente:</strong> {{ solicitudSeleccionada.paciente?.nombres | titlecase }} {{ solicitudSeleccionada.paciente?.apellidos | titlecase }}</p>
  <p><strong>Motivo:</strong> {{ solicitudSeleccionada.solicitud.motivo }}</p>

  <div class="fechas-row">
    <div class="fecha-prevista">
      <h4>Fecha Prevista</h4>
      <p>{{ solicitudSeleccionada.turno?.fecha || 'N/A' }} - {{ solicitudSeleccionada.turno?.hora || '' }}</p>
    </div>
    <div class="fecha-nueva">
      <h4>Nueva Fecha</h4>
      <p>{{ solicitudSeleccionada.solicitud.fechaPropuesta || 'No especificada' }} - {{ solicitudSeleccionada.solicitud.horaPropuesta || 'No especificada' }}</p>
    </div>
  </div>

  <div class="acciones">
    <button class="aceptar-btn" (click)="cambiarFechaTurno()">Cambiar Fecha</button>
    <button class="rechazar-btn">Eliminar Turno</button>
  </div>
</div>

<app-modal
  [showModal]="modal.show"
  [message]="modal.message"
  [isError]="modal.isError"
  [isSuccess]="modal.isSuccess"
  [isConfirm]="modal.isConfirm"
  (close)="cerrarModal()"
  (confirm)="modal.confirm && modal.confirm()">
</app-modal>